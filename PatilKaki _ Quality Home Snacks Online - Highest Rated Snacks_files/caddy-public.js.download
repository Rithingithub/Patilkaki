(function($){'use strict';var ccWindow=$('.cc-window');jQuery(document).ready(function($){$('.cc-nav ul li a').mousedown(function(){$(this).addClass('using-mouse');});$('body').keydown(function(){$('.cc-nav ul li a').removeClass('using-mouse');});var tabs=new Tabby('[data-tabs]');var productAddedFlag='no';$(document).mouseup(function(e){var container=$('.cc-window.visible, .cc-compass, #toast-container');if(!container.is(e.target)&&container.has(e.target).length===0){if(ccWindow.hasClass('visible')){$('.cc-compass').toggleClass('cc-compass-open');$('body').toggleClass('cc-window-open');$('.cc-overlay').hide();ccWindow.animate({'right':'-1000px'},'slow').removeClass('visible');if($('#toast-container').length>0){$('#toast-container').animate({'right':'25px'},'fast').toggleClass('cc-toast-open');}}}});$(document).on('click','.cc-compass',function(){$(this).toggleClass('cc-compass-open');$('body').toggleClass('cc-window-open');if('yes'!=productAddedFlag){$('.cc-pl-info-container').hide();$('.cc-window-wrapper').show();}
if(ccWindow.hasClass('visible')){$('.cc-overlay').hide();ccWindow.animate({'right':'-1000px'},'slow').removeClass('visible');}else{$('.cc-overlay').show();tabs.toggle('#cc-cart');ccWindow.animate({'right':'0'},'slow').addClass('visible');}
productAddedFlag='no';});$(document).on('click','.ccicon-x',function(){$('.cc-overlay').hide();ccWindow.animate({'right':'-1000px'},'slow').removeClass('visible');$('.cc-compass').toggleClass('cc-compass-open');$('body').toggleClass('cc-window-open');});$(document).on('click','.cc-cart-product-list .cc-cart-product a.remove_from_cart_button',function(){var button=$(this);remove_item_from_cart(button);});$(document).on('click','a.remove_from_sfl_button',function(){var button=$(this);remove_item_from_save_for_later(button);});$('body').on('added_to_cart',function(e,fragments,cart_hash,this_button){productAddedFlag='yes';var cpDeskNotice=$('.cc-compass-desk-notice').val(),cpMobNotice=$('.cc-compass-mobile-notice').val();if(cc_ajax_script.is_mobile&&!ccWindow.hasClass('visible')&&'mob_disable_notices'===cpMobNotice){$('.cc-compass').trigger('click');}else if(!cc_ajax_script.is_mobile&&!ccWindow.hasClass('visible')&&('desk_disable_notices'===cpDeskNotice||'desk_notices_caddy_window'===cpDeskNotice||''===cpDeskNotice)){$('.cc-compass').trigger('click');}});$(document).on('click','.single_add_to_cart_button, .add_to_cart_button',function(e){e.preventDefault();if($(this).hasClass('disabled')){return;}
if($(this).hasClass('product_type_variable')||$(this).hasClass('product_type_bundle')||$(this).hasClass('product_type_external')){var product_url=$(this).attr('href');window.location=product_url;return;}
var $button=$(this),$form=$button.closest('form.cart'),productData=$form.serializeArray(),hasProductId=false;$.each(productData,function(key,form_item){if(form_item.name==='productID'||form_item.name==='add-to-cart'){if(form_item.value){hasProductId=true;return false;}}});if(!hasProductId){var productID=$(this).data('product_id');}
if($button.attr('name')&&$button.attr('name')=='add-to-cart'&&$button.attr('value')){var productID=$button.attr('value');}
if(productID){productData.push({name:'add-to-cart',value:productID});}
productData.push({name:'action',value:'cc_add_to_cart'});$(document.body).trigger('adding_to_cart',[$button,productData]);$.ajax({type:'post',url:cc_ajax_script.ajaxurl,data:$.param(productData),beforeSend:function(response){$('.cc-compass').find('.licon').hide();$('.cc-compass').find('.cc-loader').show();if($('form.cart').length>0){$button.removeClass('added').addClass('loading');}},complete:function(response){if($('form.cart').length>0){$button.addClass('added').removeClass('loading');}},success:function(response){if(response.error&&response.product_url){window.location=response.product_url;return;}else{cc_cart_screen();if(!$button.hasClass('add_to_cart_button')){$(document.body).trigger('added_to_cart',[response.fragments,response.cart_hash,$button]);}}},});return false;});$(document).on('click','.cc-pl-info .cc-pl-actions .cc-view-cart',function(){tabs.toggle('#cc-cart');});$(document).on('click','.cc_item_quantity_update',function(){cc_quantity_update_buttons($(this));});$(document).on('click','.save_for_later_btn',function(){cc_save_for_later($(this));});$(document).on('click','.cc_cart_from_sfl',function(){cc_move_to_cart($(this));});$(document).on('click','.cc_back_to_cart',function(){cc_back_to_cart();});$(document).on('click','.added_to_cart.wc-forward, .woocommerce-error .button.wc-forward',function(e){e.preventDefault();cc_view_cart_button();});$(document).on('click','.cc_saved_items_list',function(){cc_saved_item_list();});$(document).on('click','.cc_cart_items_list',function(){cc_cart_item_list();});$(document).on('click','.cc_add_product_to_sfl',function(){cc_add_product_to_sfl($(this));});$(document).on('click','.cc-view-saved-items',function(){var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-saves');});if($('.variations_form').length>0){$('.cc_add_product_to_sfl').addClass('disabled');$(this).each(function(){$(this).on('found_variation',function(event,variation){$('.cc_add_product_to_sfl').removeClass('disabled');});$(this).on('reset_data',function(){$('.cc_add_product_to_sfl').addClass('disabled');});});}
$(document).on('submit','#apply_coupon_form',function(e){e.preventDefault();cc_coupon_code_applied_from_cart_screen();});$(document).on('click','.cc-applied-coupon .cc-remove-coupon',function(){cc_coupon_code_removed_from_cart_screen($(this));});$(document).on('click','.cc-nav ul li a',function(){var current_tab=$(this).attr('data-id');if('cc-cart'===current_tab){$('.cc-pl-upsells-slider').resize();}});});$(window).load(function(){$('.cc-compass .cc-compass-count').show();});function cc_cart_screen(productAdded=''){var data={action:'cc_update_window_data',};$.ajax({type:'post',url:cc_ajax_script.ajaxurl,data:data,success:function(response){var fragments=response.fragments;if(fragments){$.each(fragments,function(key,value){$(key).replaceWith(value);});}
var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-cart');if('yes'==productAdded){$('.cc-window-wrapper').hide();}
if('move_to_cart'===productAdded){$('.cc_cart_from_sfl').removeClass('cc_hide_btn');$('.cc_cart_from_sfl').parent().find('.cc-loader').hide();$('.cc-coupon .woocommerce-notices-wrapper').remove();}else{$('.cc-compass').find('.cc-loader').hide();$('.cc-compass').find('.licon').show();}
var flatsome_product_redirect=response.flatsome_product_redirect;if('no'===flatsome_product_redirect){return false;}}});}
var cc_quanity_update_send=true;function cc_quantity_update_buttons(el){if(cc_quanity_update_send){cc_quanity_update_send=false;$('.cc-notice').hide();var wrap=$(el).parents('.cc-cart-product-list');var input=$(wrap).find('.cc_item_quantity');var key=$(input).data('key');var productID=$(input).data('product_id');var number=parseInt($(input).val());var type=$(el).data('type');if('minus'==type){number--;}else{number++;}
if(number<1){number=1;}
var data={action:'cc_quantity_update',key:key,number:number,product_id:productID,security:cc_ajax_script.nonce};$.ajax({type:'post',url:cc_ajax_script.ajaxurl,data:data,success:function(response){var fragments=response.fragments,qty_error_msg=response.qty_error_msg;if(fragments){$.each(fragments,function(key,value){$(key).replaceWith(value);});}
if(qty_error_msg){$('.cc-notice').addClass('cc-error').show().html(qty_error_msg);setTimeout(function(){$('.cc-notice').removeClass('cc-error').html('').hide();},2000);}
$(input).val(number);cc_quanity_update_send=true;var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-cart');}});}}
function cc_save_for_later($button){var product_id=$button.data('product_id');var cart_item_key=$button.data('cart_item_key');var data={action:'cc_save_for_later',security:cc_ajax_script.nonce,product_id:product_id,cart_item_key:cart_item_key};$.ajax({type:'post',dataType:'json',url:cc_ajax_script.ajaxurl,data:data,beforeSend:function(response){$button.addClass('cc_hide_btn');$button.parent().find('.cc-loader').show();},complete:function(response){$button.removeClass('cc_hide_btn');$button.parent().find('.cc-loader').hide();},success:function(response){var fragments=response.fragments;if(fragments){$.each(fragments,function(key,value){$(key).replaceWith(value);});}
var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-saves');}});}
function cc_move_to_cart($button){var product_id=$button.data('product_id');var data={action:'cc_move_to_cart',security:cc_ajax_script.nonce,product_id:product_id,};$.ajax({type:'post',dataType:'json',url:cc_ajax_script.ajaxurl,data:data,beforeSend:function(response){$button.addClass('cc_hide_btn');$button.parent().find('.cc-loader').show();},success:function(response){if(response.error){$button.removeClass('cc_hide_btn');$button.parent().find('.cc-loader').hide();var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-saves');$('.cc-sfl-notice').show().html(response.error_message);setTimeout(function(){$('.cc-sfl-notice').html('').hide();},2000);}else{var recommendedProducts=response.product_recommended;if(recommendedProducts){$('.cc-pl-info-wrapper').html(recommendedProducts);}
cc_cart_screen('move_to_cart');}}});}
function remove_item_from_cart(button){var cartItemKey=button.data('cart_item_key'),productName=button.data('product_name'),product_id=button.data('product_id');var data={action:'cc_remove_item_from_cart',nonce:cc_ajax_script.nonce,cart_item_key:cartItemKey};$.ajax({type:'post',url:cc_ajax_script.ajaxurl,data:data,complete:function(response){if(($('.single_add_to_cart_button, .add_to_cart_button').length>0)){$('.single_add_to_cart_button.added, .add_to_cart_button.added').each(function(){if($('form.cart').length>0&&!$(this).hasClass('add_to_cart_button')){var $form=$(this).closest('form.cart'),atc_product_id=$form.find('input[name=add-to-cart]').val()||$(this).val(),atc_variation_id=$form.find('input[name=variation_id]').val()||0;if(atc_variation_id!==0){atc_product_id=atc_variation_id;}}else{var atc_product_id=$(this).data('product_id');}
if(atc_product_id==product_id){if($(this).hasClass('added')){$(this).removeClass('added');}}});}},success:function(response){var fragments=response.fragments;if(fragments){$.each(fragments,function(key,value){$(key).replaceWith(value);});}
var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-cart');}});}
function remove_item_from_save_for_later(button){var productID=button.data('product_id');var data={action:'cc_remove_item_from_sfl',nonce:cc_ajax_script.nonce,product_id:productID};$.ajax({type:'post',url:cc_ajax_script.ajaxurl,data:data,success:function(response){var fragments=response.fragments;if(fragments){$.each(fragments,function(key,value){$(key).replaceWith(value);});}
var sfl_btn=$('a.cc-sfl-btn.remove_from_sfl_button');if(sfl_btn.has('i.ccicon-heart-filled')){sfl_btn.find('i').removeClass('ccicon-heart-filled').addClass('ccicon-heart-empty');var sfl_btn_text=sfl_btn.find('span').text();if(sfl_btn_text.length>0){sfl_btn.find('span').text('Save for later');}
sfl_btn.removeClass('remove_from_sfl_button').addClass('cc_add_product_to_sfl');}
var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-saves');}});}
function cc_back_to_cart(){$('.cc-pl-info-container').hide();$('.cc-window-wrapper').show();}
function cc_view_cart_button(){if(!ccWindow.hasClass('visible')){$('.cc-compass').trigger('click');}}
function cc_saved_item_list(){$('.cc-compass').toggleClass('cc-compass-open');$('body').toggleClass('cc-window-open');$('.cc-pl-info-container').hide();$('.cc-window-wrapper').show();$('.cc-overlay').show();var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-saves');ccWindow.animate({'right':'0'},'slow').addClass('visible');}
function cc_cart_item_list(){if(!ccWindow.hasClass('visible')){$('.cc-compass').trigger('click');}}
function cc_add_product_to_sfl($button){var product_id=$button.data('product_id'),product_type=$button.data('product_type');if('variable'==product_type){product_id=$button.parent().find('.variation_id').val();}
if(0!==product_id&&(!$button.hasClass('disabled'))){var data={action:'add_product_to_sfl_action',nonce:cc_ajax_script.nonce,product_id:product_id};$.ajax({type:'post',url:cc_ajax_script.ajaxurl,data:data,success:function(response){var fragments=response.fragments;if(fragments){$.each(fragments,function(key,value){$(key).replaceWith(value);});}
if($($button).has('i.ccicon-heart-empty')){$($button).find('i').removeClass('ccicon-heart-empty').addClass('ccicon-heart-filled');var sfl_btn_text=$($button).find('span').text();if(sfl_btn_text.length>0){$($button).find('span').text('Saved');}
$($button).removeClass('cc_add_product_to_sfl').addClass('remove_from_sfl_button');}
if(response.cc_compass_open){cc_saved_item_list();}else{var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-saves');}}});}}
function cc_coupon_code_applied_from_cart_screen(){var coupon_code=$('.cc-coupon-form #cc_coupon_code').val();var data={action:'cc_apply_coupon_to_cart',nonce:cc_ajax_script.nonce,coupon_code:coupon_code};$.ajax({type:'post',url:cc_ajax_script.ajaxurl,data:data,success:function(response){var fragments=response.fragments,caddy_cart_subtotal=response.caddy_cart_subtotal;if(fragments){$.each(fragments,function(key,value){$(key).replaceWith(value);});}
$('.cc-total-amount').html(caddy_cart_subtotal);var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-cart');}});}
function cc_coupon_code_removed_from_cart_screen($remove_code){var coupon_code_to_remove=$remove_code.parent('.cc-applied-coupon').find('.cc_applied_code').text();var data={action:'cc_remove_coupon_code',nonce:cc_ajax_script.nonce,coupon_code_to_remove:coupon_code_to_remove};$.ajax({type:'post',url:cc_ajax_script.ajaxurl,data:data,success:function(response){var fragments=response.fragments,fs_title=response.free_shipping_title,fs_meter=response.free_shipping_meter,final_cart_subtotal=response.final_cart_subtotal;if(fragments){$.each(fragments,function(key,value){$(key).replaceWith(value);});}
$('.cc-fs-title').html(fs_title);$('.cc-fs-meter').html(fs_meter);$('.cc-total-amount').html(final_cart_subtotal);var tabs=new Tabby('[data-tabs]');tabs.toggle('#cc-cart');}});}})(jQuery);